{
  "hash": "1e0d7dc406c8e881db01b4bcc8c7aa7d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Walkthrough of `fingertips_py`\"\nformat:\n  html: default\n  ipynb: default\n---\n\nIn conjunction with the tutorial on [webscraping and APIs](sessions/intermediate-skills/18-webscraping-apis/index.html), below is a walkthrough of  the `fingertips_py` package maintained by the Department of Health and Social Care, which simplifies importing data via the Fingertips API.\n\n## Documentation\n\n[Fingertips Public Health Profiles (public-facing source of the data)](https://fingertips.phe.org.uk/profiles)\n\n[Fingertips Python API package (fingertips_py) documentation](https://fingertips-py.readthedocs.io/en/latest/)\n\n[Package repository](https://github.com/DataS-DHSC/fingertips_py)\n\n## Installation\n\nFor more information, see the fingertips_py documentation.\n\nCode Club recommends using the uv package management software, but if you do need to use pip, the relevant installation instructions are below.\n\n### uv\n\nTo install using uv, enter the following in the terminal:\n\n```\nuv add fingertips_py\n```\n\n### pip\n\nTo install using pip, activate your environment and enter the following in the terminal:\n\n```\npython -m pip install fingertips_py\n```\n\n## Exploring package functionality\n\nLet's have a look at the various methods in the package that allow us to import different levels of the dataset and the metadata.\n\n### Importing the package\n\nWe will also use `pandas` for presenting the imported data in a dataframe.\n\n::: {#import-packages .cell execution_count=1}\n``` {.python .cell-code}\nimport fingertips_py as ftp\n\nimport pandas as pd\n```\n:::\n\n\n### Get profile IDs by profile name\n\nThe profile IDs can be used to refer to different \"profiles\" on Fingertips. That is to say, different aspects of public health such as levels of diabetes, cardiovascular disease, or dementia in the country.\n\n::: {#get-profile-ids .cell execution_count=2}\n``` {.python .cell-code}\n# Cancer profile ID\ncancer_profile_md = ftp.metadata.get_profile_by_name('cancer services') # creates a dictionary of metadata. Profile names are not case sensitive.\n\ncancer_profile_id = cancer_profile_md['Id'] # access the profile ID in the metadata dictionary\n\n# Wider Determinants of Health profile ID\n\nwdoh_profile_md = ftp.metadata.get_profile_by_name('wider determinants of health')\n\nwdoh_profile_id = wdoh_profile_md['Id']\n\n# Return the IDs\n\nprint(f'Cancer profile ID: {cancer_profile_id}')\nprint(f'Wider Determinants of Health profile ID: {wdoh_profile_id}')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCancer profile ID: 92\nWider Determinants of Health profile ID: 130\n```\n:::\n:::\n\n\n### Get profile metadata as a dataframe\n\nInspecting the metadata gives you a lot of information about a given profile, such as metric sources, definition, and polarity.\n\n::: {#cell-wdoh-metadata .cell execution_count=3}\n``` {.python .cell-code}\nwdoh_md_df = ftp.metadata.get_metadata_for_profile_as_dataframe(wdoh_profile_id)\n\nwdoh_md_df.head()\n```\n\n::: {#wdoh-metadata .cell-output .cell-output-display execution_count=3}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator</th>\n      <th>Indicator number</th>\n      <th>Rationale</th>\n      <th>Specific rationale</th>\n      <th>Definition</th>\n      <th>Data source</th>\n      <th>Indicator source</th>\n      <th>Definition of numerator</th>\n      <th>Source of numerator</th>\n      <th>...</th>\n      <th>Data re-use</th>\n      <th>Links</th>\n      <th>Indicator Content</th>\n      <th>Simple Name</th>\n      <th>Simple Definition</th>\n      <th>Unit</th>\n      <th>Value type</th>\n      <th>Year type</th>\n      <th>Polarity</th>\n      <th>Date updated</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>11401</td>\n      <td>The rate of complaints about noise</td>\n      <td>B14a</td>\n      <td>The Government's policy on noise is set out in...</td>\n      <td>NaN</td>\n      <td>Number of complaints per year per local author...</td>\n      <td>OHID, in collaboration with Chartered Institut...</td>\n      <td>Data on noise complaints provided by Chartered...</td>\n      <td>Number of complaints about noise.</td>\n      <td>Chartered Institute of Environmental Health (C...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>http://www.cieh.org/</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>per 1,000</td>\n      <td>Crude rate</td>\n      <td>Financial</td>\n      <td>RAG - Low is good</td>\n      <td>11/04/2025</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>93754</td>\n      <td>Killed and seriously injured casualties on Eng...</td>\n      <td>B10</td>\n      <td>Motor vehicle traffic accidents are a major ca...</td>\n      <td>NaN</td>\n      <td>Number of people reported killed or seriously ...</td>\n      <td>OHID, based on Department for Transport data</td>\n      <td>NaN</td>\n      <td>The number of people of all ages killed or ser...</td>\n      <td>Department for Transport (DfT), Road accidents...</td>\n      <td>...</td>\n      <td>Killed and seriously injured data are National...</td>\n      <td>&lt;span style=\"color: #0b0c0c; font-family: GDS ...</td>\n      <td>NaN</td>\n      <td>People killed or seriously injured on roads</td>\n      <td>Rate of people reported killed or seriously in...</td>\n      <td>per billion vehicle miles</td>\n      <td>Crude rate</td>\n      <td>Calendar</td>\n      <td>RAG - Low is good</td>\n      <td>22/10/2025</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>93074</td>\n      <td>Access to Healthy Assets &amp; Hazards Index</td>\n      <td>NaN</td>\n      <td>The Access to Healthy Assets and Hazards (AHAH...</td>\n      <td>NaN</td>\n      <td>Percentage of the population who live in LSOAs...</td>\n      <td>Consumer Data Research Centre</td>\n      <td>The overall index collates data from a variety...</td>\n      <td>Total population residing in Lower Super Outpu...</td>\n      <td>Consumer Data Research Centre (CDRC), Access t...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>https://data.cdrc.ac.uk/dataset/access-healthy...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>%</td>\n      <td>Proportion</td>\n      <td>Calendar</td>\n      <td>RAG - Low is good</td>\n      <td>03/09/2024</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>90357</td>\n      <td>The percentage of the population exposed to ro...</td>\n      <td>B14b</td>\n      <td>There are a number of direct and indirect link...</td>\n      <td>NaN</td>\n      <td>Noise exposure determined by strategic noise m...</td>\n      <td>OHID, based on Department for Environment, Foo...</td>\n      <td>NaN</td>\n      <td>Noise exposure determined by strategic noise m...</td>\n      <td>Department for Environment, Food and Rural Aff...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>%</td>\n      <td>Proportion</td>\n      <td>Calendar</td>\n      <td>RAG - Low is good</td>\n      <td>23/01/2025</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>94124</td>\n      <td>Fast food outlets per 100,000 population</td>\n      <td>NaN</td>\n      <td>&lt;p class=\"MsoNormal\" style=\"margin-bottom: 0cm...</td>\n      <td>NaN</td>\n      <td>&lt;p class=\"MsoNormal\" style=\"margin-bottom: 0cm...</td>\n      <td>OHID, based on Food Standards Agency data</td>\n      <td>NaN</td>\n      <td>&lt;span style=\"line-height: 107%; mso-fareast-fo...</td>\n      <td>Food Standards Agency (FSA), Food Hygiene Rati...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>per 100,000</td>\n      <td>Crude rate</td>\n      <td>Calendar</td>\n      <td>RAG - Low is good</td>\n      <td>24/01/2025</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 32 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Get metadata by indicator ID\n\n::: {#cell-fastfood-indicator .cell execution_count=4}\n``` {.python .cell-code}\nfast_food_md = ftp.get_metadata_for_indicator_as_dataframe(94124)\n\nfast_food_md\n```\n\n::: {#fastfood-indicator .cell-output .cell-output-display execution_count=4}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator</th>\n      <th>Indicator number</th>\n      <th>Rationale</th>\n      <th>Specific rationale</th>\n      <th>Definition</th>\n      <th>Data source</th>\n      <th>Indicator source</th>\n      <th>Definition of numerator</th>\n      <th>Source of numerator</th>\n      <th>...</th>\n      <th>Data re-use</th>\n      <th>Links</th>\n      <th>Indicator Content</th>\n      <th>Simple Name</th>\n      <th>Simple Definition</th>\n      <th>Unit</th>\n      <th>Value type</th>\n      <th>Year type</th>\n      <th>Polarity</th>\n      <th>Date updated</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>94124</td>\n      <td>Fast food outlets per 100,000 population</td>\n      <td>NaN</td>\n      <td>&lt;p class=\"MsoNormal\" style=\"margin-bottom: 0cm...</td>\n      <td>NaN</td>\n      <td>&lt;p class=\"MsoNormal\" style=\"margin-bottom: 0cm...</td>\n      <td>OHID, based on Food Standards Agency data</td>\n      <td>NaN</td>\n      <td>&lt;span style=\"line-height: 107%; mso-fareast-fo...</td>\n      <td>Food Standards Agency (FSA), Food Hygiene Rati...</td>\n      <td>...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>per 100,000</td>\n      <td>Crude rate</td>\n      <td>Calendar</td>\n      <td>RAG - Low is good</td>\n      <td>24/01/2025</td>\n    </tr>\n  </tbody>\n</table>\n<p>1 rows × 32 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Get all area types\n\nThis can help you understand which geographical breakdowns are available via the API. The code below just returns the first 10 so that a large table doesn't get displayed on this page, but there are many more. Worth looking into, if you are planning to make use of these metrics to support the narrative in a report you are working on.\n\n::: {#cell-all-areas .cell execution_count=5}\n``` {.python .cell-code}\n# returns a nested dictionary, where the area ID is the key to a further dictionary of key:value pairs\nall_areas_dict = ftp.metadata.get_all_areas()\n\n# converts the nested dictionary to a DataFrame, where the outer key becomes the index\nall_areas_df = pd.DataFrame.from_dict(all_areas_dict, orient='index') \n\n# reset the DataFrame to have the default indexing\nall_areas_df = all_areas_df.reset_index() \n\n# rename the column labelled 'index' in the dictionary-to-DataFrame conversion\nall_areas_df.rename(columns={'index':'Id'}, inplace=True) \n\nall_areas_df.head(10)\n```\n\n::: {#all-areas .cell-output .cell-output-display execution_count=5}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Id</th>\n      <th>Name</th>\n      <th>Short</th>\n      <th>Class</th>\n      <th>CanBeDisplayedOnMap</th>\n      <th>Sequence</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>3</td>\n      <td>Middle Super Output Area</td>\n      <td>MSOA</td>\n      <td>None</td>\n      <td>True</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>6</td>\n      <td>Government Office Region (E12)</td>\n      <td>Regions (statistical)</td>\n      <td>None</td>\n      <td>True</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>7</td>\n      <td>General Practice</td>\n      <td>GPs</td>\n      <td>gp</td>\n      <td>True</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>8</td>\n      <td>Electoral Best Fit Wards (2024)</td>\n      <td>Electoral Wards (2024)</td>\n      <td>None</td>\n      <td>True</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>9</td>\n      <td>Census Merged Wards</td>\n      <td>Merged Wards</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>14</td>\n      <td>Acute Trust</td>\n      <td>Acute Trust</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>15</td>\n      <td>England</td>\n      <td>England</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>20</td>\n      <td>Mental Health Trust</td>\n      <td>Mental Health Trust</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>41</td>\n      <td>Ambulance Trust</td>\n      <td>Ambulance Trust</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>66</td>\n      <td>Sub-ICB, former CCGs</td>\n      <td>ICB sub-locations</td>\n      <td>None</td>\n      <td>True</td>\n      <td>2022</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Get all area types available for a particular profile\n\n::: {#cell-all-areas-profile .cell execution_count=6}\n``` {.python .cell-code}\nwdoh_areas = ftp.metadata.get_area_types_for_profile(wdoh_profile_id)\n\nwdoh_areas_df = pd.DataFrame.from_dict(wdoh_areas, orient='index')\n\nwdoh_areas_df.reset_index(inplace=True)\n\nwdoh_areas_df.drop('index', axis=1,inplace=True) # drop the column called 'index' following the dictionary-to-DataFrame conversion\n\nwdoh_areas_df\n```\n\n::: {#all-areas-profile .cell-output .cell-output-display execution_count=6}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Name</th>\n      <th>Short</th>\n      <th>Class</th>\n      <th>CanBeDisplayedOnMap</th>\n      <th>Sequence</th>\n      <th>Id</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Government Office Region (E12)</td>\n      <td>Regions (statistical)</td>\n      <td>None</td>\n      <td>True</td>\n      <td>0</td>\n      <td>6</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>England</td>\n      <td>England</td>\n      <td>None</td>\n      <td>False</td>\n      <td>0</td>\n      <td>15</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Lower tier local authorities (post 4/23)</td>\n      <td>Districts &amp; UAs (from Apr 2023)</td>\n      <td>ua-la-composite</td>\n      <td>True</td>\n      <td>2023</td>\n      <td>501</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Upper tier local authorities (post 4/23)</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>ua-county-composite</td>\n      <td>True</td>\n      <td>2023</td>\n      <td>502</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n### Get all data for indicators\n\nThere seems to be an error within this function at time of writing since it constructs an invalid URL. It has been kept in this demonstration so that you can be made aware that this method may not work, unless it has been fixed.\n\n`ftp.retrieve_data.get_all_data_for_indicators`\n\n::: {#get-all-error .cell execution_count=7}\n``` {.python .cell-code}\nwdoh_indicators_df = pd.DataFrame(\n    ftp.retrieve_data.get_all_data_for_indicators(\n        [11404,92772],                  # two Wider Determinants of Health indicators\n         502,                           # Area type = Upper tier local authorities\n         15,                            # Parent area type =  England\n         filter_by_area_codes= None,\n         is_test= False\n    )\n)\n\nwdoh_indicators_df.head()\n```\n:::\n\n\n#### Let's try this one instead\n\nThis one does much the same thing, though slightly differently, while not causing an error.\n\n`fingertips_py.retrieve_data.get_data_by_indicator_ids`\n\n::: {#cell-get-all-success .cell execution_count=8}\n``` {.python .cell-code}\nwdoh_indicators_df = pd.DataFrame(\n    ftp.retrieve_data.get_data_by_indicator_ids(\n        [11404,92772],                          # two Wider Determinants of Health indicators\n         502,                                   # Area type = Upper tier local authorities\n         15,                                    # Parent area type =  England\n         include_sortable_time_periods=None,\n         is_test= False\n    )\n)\n\nwdoh_indicators_df.head()\n```\n\n::: {#get-all-success .cell-output .cell-output-display execution_count=7}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator Name</th>\n      <th>Parent Code</th>\n      <th>Parent Name</th>\n      <th>Area Code</th>\n      <th>Area Name</th>\n      <th>Area Type</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>Category Type</th>\n      <th>...</th>\n      <th>Count</th>\n      <th>Denominator</th>\n      <th>Value note</th>\n      <th>Recent Trend</th>\n      <th>Compared to England value or percentiles</th>\n      <th>Compared to percentiles</th>\n      <th>Time period Sortable</th>\n      <th>New data</th>\n      <th>Compared to goal</th>\n      <th>Time period range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>England</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>154487.0</td>\n      <td>130310.0136</td>\n      <td>Aggregated from all known lower geography values</td>\n      <td>NaN</td>\n      <td>Not compared</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>England</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>154487.0</td>\n      <td>130310.0136</td>\n      <td>Aggregated from all known lower geography values</td>\n      <td>NaN</td>\n      <td>Similar</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000001</td>\n      <td>Hartlepool</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>312.0</td>\n      <td>93.5595</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000002</td>\n      <td>Middlesbrough</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>347.0</td>\n      <td>53.8888</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000003</td>\n      <td>Redcar and Cleveland</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>361.0</td>\n      <td>244.8202</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 27 columns</p>\n</div>\n```\n:::\n:::\n\n\n### Get data at all available geographies for a particular indicator\n\n::: {#cell-get-all-at-all-geog .cell execution_count=9}\n``` {.python .cell-code}\nlicensed_premises_all_geographies = ftp.retrieve_data.get_data_for_indicator_at_all_available_geographies(92772)\n\nlicensed_premises_all_geographies.head()\n```\n\n::: {#get-all-at-all-geog .cell-output .cell-output-display execution_count=8}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator Name</th>\n      <th>Parent Code</th>\n      <th>Parent Name</th>\n      <th>Area Code</th>\n      <th>Area Name</th>\n      <th>Area Type</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>Category Type</th>\n      <th>...</th>\n      <th>Count</th>\n      <th>Denominator</th>\n      <th>Value note</th>\n      <th>Recent Trend</th>\n      <th>Compared to England value or percentiles</th>\n      <th>Compared to percentiles</th>\n      <th>Time period Sortable</th>\n      <th>New data</th>\n      <th>Compared to goal</th>\n      <th>Time period range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>England</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>154487.0</td>\n      <td>130310.0136</td>\n      <td>Aggregated from all known lower geography values</td>\n      <td>NaN</td>\n      <td>Not compared</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>England</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>154487.0</td>\n      <td>130310.0136</td>\n      <td>Aggregated from all known lower geography values</td>\n      <td>NaN</td>\n      <td>Similar</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000001</td>\n      <td>Hartlepool</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>312.0</td>\n      <td>93.5595</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000002</td>\n      <td>Middlesbrough</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>347.0</td>\n      <td>53.8888</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>92772</td>\n      <td>Premises licensed to sell alcohol per square k...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000003</td>\n      <td>Redcar and Cleveland</td>\n      <td>Counties &amp; UAs (from Apr 2023)</td>\n      <td>Not applicable</td>\n      <td>Not applicable</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>361.0</td>\n      <td>244.8202</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20150000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 27 columns</p>\n</div>\n```\n:::\n:::\n\n\n#### Let's check whether it has included all geographies by getting a list of unique area types\n\n::: {#cell-geog-set .cell execution_count=10}\n``` {.python .cell-code}\nset(licensed_premises_all_geographies['Area Type'])\n```\n\n::: {#geog-set .cell-output .cell-output-display execution_count=9}\n```\n{'Counties & UAs (2021/22-2022/23)',\n 'Counties & UAs (from Apr 2023)',\n 'Districts & UAs (2021/22-2022/23)',\n 'Districts & UAs (from Apr 2023)',\n 'England',\n 'Regions (statistical)'}\n```\n:::\n:::\n\n\n### Let's put all this together and visualise it on a map\n\nWe will need to import some more packages:\n\n- [Geopandas](https://geopandas.org/en/stable/docs.html): supports combining geographical data with `pandas` DataFrames.\n- [Contextily](https://contextily.readthedocs.io/en/latest/index.html): used for laying maps over geographical shapes, such as maps provided by [OpenStreetMap](https://www.openstreetmap.org/about).\n- [Matplotlib](https://matplotlib.org/3.5.3/api/_as_gen/matplotlib.pyplot.html): user for applying shading to geographical shapes, adding a legend and any other useful chart elements.\n\n::: {#import-geopandas .cell execution_count=11}\n``` {.python .cell-code}\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\nimport contextily as cx\n```\n:::\n\n\nLet's plot \"Child Poverty, Income deprivation affecting children index (IDACI) 2019 Proportion %\" in Bracknell Forest Local Authority area by MSOA. Let's imagine we found this metric on the Fingertips website and want to import the data so that we can create a custom visualisation to go into some background narrative to a report.\n\nFirstly, we need the profile ID for the Profile \"Local health, public health data for small geographic areas\". Then we can get the profile metadata as a dataframe so that we can see how the metric we are interested is referred to within the dataset.\n\n::: {#cell-get-idaci .cell execution_count=12}\n``` {.python .cell-code}\nsmall_geographic_areas_md = ftp.metadata.get_profile_by_name('Local health, public health data for small geographic areas')\n\n# access the profile ID in the metadata dictionary\nsmall_geographic_areas_id = small_geographic_areas_md['Id']\n\n# get a metadata dataframe for the profile in question\nsmall_geographic_areas_md_df = ftp.metadata.get_metadata_for_profile_as_dataframe(small_geographic_areas_id)\n\n# get the indicator ID and name where the name contains \"IDACI\"\nidaci = small_geographic_areas_md_df[['Indicator ID','Indicator']][small_geographic_areas_md_df['Indicator'].str.contains('IDACI')]\n\n# inspect the metrics in our \"idaci\" variable\nidaci\n```\n\n::: {#get-idaci .cell-output .cell-output-display execution_count=11}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>6</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nThere's only one indicator with \"IDACI\" in the name, so we can go ahead and use the indicator ID to get the data for the metric we are interested in at MSOA level.\n\n::: {#cell-idaci-df .cell execution_count=13}\n``` {.python .cell-code}\nidaci_id = idaci['Indicator ID'].iloc[0] # gets the entry from the Indicator ID column\n\nidaci_df = pd.DataFrame(\n    ftp.retrieve_data.get_data_by_indicator_ids(\n        idaci_id,\n        3, # MSOA\n        501 # Local Authority\n    )\n)\n\nidaci_df.head()\n```\n\n::: {#idaci-df .cell-output .cell-output-display execution_count=12}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Indicator ID</th>\n      <th>Indicator Name</th>\n      <th>Parent Code</th>\n      <th>Parent Name</th>\n      <th>Area Code</th>\n      <th>Area Name</th>\n      <th>Area Type</th>\n      <th>Sex</th>\n      <th>Age</th>\n      <th>Category Type</th>\n      <th>...</th>\n      <th>Count</th>\n      <th>Denominator</th>\n      <th>Value note</th>\n      <th>Recent Trend</th>\n      <th>Compared to England value or percentiles</th>\n      <th>Compared to Districts &amp; UAs (from Apr 2023) value or percentiles</th>\n      <th>Time period Sortable</th>\n      <th>New data</th>\n      <th>Compared to goal</th>\n      <th>Time period range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>England</td>\n      <td>Persons</td>\n      <td>&lt;16 yrs</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>1777641.757</td>\n      <td>10405050</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Not compared</td>\n      <td>Not compared</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000001</td>\n      <td>Hartlepool</td>\n      <td>Districts &amp; UAs (from Apr 2023)</td>\n      <td>Persons</td>\n      <td>&lt;16 yrs</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>4978.719</td>\n      <td>17580</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000002</td>\n      <td>Middlesbrough</td>\n      <td>Districts &amp; UAs (from Apr 2023)</td>\n      <td>Persons</td>\n      <td>&lt;16 yrs</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>9359.504</td>\n      <td>28622</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000003</td>\n      <td>Redcar and Cleveland</td>\n      <td>Districts &amp; UAs (from Apr 2023)</td>\n      <td>Persons</td>\n      <td>&lt;16 yrs</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>6195.212</td>\n      <td>24210</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>93094</td>\n      <td>Children in poverty: Income Deprivation Affect...</td>\n      <td>E92000001</td>\n      <td>England</td>\n      <td>E06000004</td>\n      <td>Stockton-on-Tees</td>\n      <td>Districts &amp; UAs (from Apr 2023)</td>\n      <td>Persons</td>\n      <td>&lt;16 yrs</td>\n      <td>NaN</td>\n      <td>...</td>\n      <td>7965.449</td>\n      <td>38168</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Worse</td>\n      <td>Not compared</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 27 columns</p>\n</div>\n```\n:::\n:::\n\n\nNow we can import the data for the geographic mapping. For this we will use a .geojson boundary shape file downloaded from the [Open Geography Portal](https://geoportal.statistics.gov.uk/).\n\n::: {#cell-import-geojson .cell execution_count=14}\n``` {.python .cell-code}\ngdf = gpd.read_file('data/MSOA_Dec_2011_Boundaries_Super_Generalised_Clipped_BSC_EW_V3_2022_-5254045062471510471.geojson')\n\ngdf.head()\n```\n\n::: {#import-geojson .cell-output .cell-output-display execution_count=13}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>OBJECTID</th>\n      <th>MSOA11CD</th>\n      <th>MSOA11NM</th>\n      <th>MSOA11NMW</th>\n      <th>BNG_E</th>\n      <th>BNG_N</th>\n      <th>LONG</th>\n      <th>LAT</th>\n      <th>GlobalID</th>\n      <th>geometry</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1</td>\n      <td>E02000001</td>\n      <td>City of London 001</td>\n      <td>City of London 001</td>\n      <td>532378</td>\n      <td>181354</td>\n      <td>-0.093570</td>\n      <td>51.51560</td>\n      <td>a9f03568-7a0a-42b8-a23e-1271f76431e1</td>\n      <td>POLYGON ((-0.08519 51.52034, -0.07845 51.52151...</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>2</td>\n      <td>E02000002</td>\n      <td>Barking and Dagenham 001</td>\n      <td>Barking and Dagenham 001</td>\n      <td>548267</td>\n      <td>189693</td>\n      <td>0.138759</td>\n      <td>51.58659</td>\n      <td>f0ca54f0-1a1e-4c72-8fcb-85e21be6de79</td>\n      <td>POLYGON ((0.14984 51.59701, 0.15111 51.58708, ...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>3</td>\n      <td>E02000003</td>\n      <td>Barking and Dagenham 002</td>\n      <td>Barking and Dagenham 002</td>\n      <td>548259</td>\n      <td>188522</td>\n      <td>0.138150</td>\n      <td>51.57607</td>\n      <td>3772a2ec-b052-4000-b62b-2c85ac401a7f</td>\n      <td>POLYGON ((0.14841 51.58075, 0.14978 51.5697, 0...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>4</td>\n      <td>E02000004</td>\n      <td>Barking and Dagenham 003</td>\n      <td>Barking and Dagenham 003</td>\n      <td>551004</td>\n      <td>186418</td>\n      <td>0.176830</td>\n      <td>51.55644</td>\n      <td>3388e1f6-e578-4907-b271-168756f05856</td>\n      <td>POLYGON ((0.19021 51.55268, 0.18602 51.54754, ...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>5</td>\n      <td>E02000005</td>\n      <td>Barking and Dagenham 004</td>\n      <td>Barking and Dagenham 004</td>\n      <td>548733</td>\n      <td>186827</td>\n      <td>0.144269</td>\n      <td>51.56071</td>\n      <td>1af0aed4-60d0-4fd6-b326-4b868968c12f</td>\n      <td>POLYGON ((0.15441 51.56607, 0.1479 51.56109, 0...</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nNext, we join it to the Fingertips data so that the metric data and the geographical data are all in one dataframe.\n\n::: {#cell-merge-geojson .cell execution_count=15}\n``` {.python .cell-code}\nboundary_df = pd.merge(\n    left= gdf,\n    right= idaci_df,\n    left_on= 'MSOA11CD',\n    right_on= 'Area Code',\n    how= 'right' \n)\n\nboundary_df = boundary_df[boundary_df['Parent Name'] == 'Bracknell Forest'] # just get data where the parent area (i.e. local authority) is Bracknell Forest\n\nboundary_df.head()\n```\n\n::: {#merge-geojson .cell-output .cell-output-display execution_count=14}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>OBJECTID</th>\n      <th>MSOA11CD</th>\n      <th>MSOA11NM</th>\n      <th>MSOA11NMW</th>\n      <th>BNG_E</th>\n      <th>BNG_N</th>\n      <th>LONG</th>\n      <th>LAT</th>\n      <th>GlobalID</th>\n      <th>geometry</th>\n      <th>...</th>\n      <th>Count</th>\n      <th>Denominator</th>\n      <th>Value note</th>\n      <th>Recent Trend</th>\n      <th>Compared to England value or percentiles</th>\n      <th>Compared to Districts &amp; UAs (from Apr 2023) value or percentiles</th>\n      <th>Time period Sortable</th>\n      <th>New data</th>\n      <th>Compared to goal</th>\n      <th>Time period range</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>3497</th>\n      <td>3263.0</td>\n      <td>E02003352</td>\n      <td>Bracknell Forest 001</td>\n      <td>Bracknell Forest 001</td>\n      <td>491853.0</td>\n      <td>172163.0</td>\n      <td>-0.67980</td>\n      <td>51.44102</td>\n      <td>3c549766-9728-4db5-b739-7c766b7413c1</td>\n      <td>POLYGON ((-0.65676 51.46149, -0.65822 51.44932...</td>\n      <td>...</td>\n      <td>34.968</td>\n      <td>1018</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Better</td>\n      <td>Better</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3498</th>\n      <td>3264.0</td>\n      <td>E02003353</td>\n      <td>Bracknell Forest 002</td>\n      <td>Bracknell Forest 002</td>\n      <td>486081.0</td>\n      <td>171506.0</td>\n      <td>-0.76298</td>\n      <td>51.43602</td>\n      <td>ae2b8239-e38a-4f1c-90fe-f290fbc538e8</td>\n      <td>POLYGON ((-0.75275 51.46223, -0.74107 51.45887...</td>\n      <td>...</td>\n      <td>64.414</td>\n      <td>1752</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Better</td>\n      <td>Better</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3499</th>\n      <td>3265.0</td>\n      <td>E02003354</td>\n      <td>Bracknell Forest 003</td>\n      <td>Bracknell Forest 003</td>\n      <td>487683.0</td>\n      <td>170212.0</td>\n      <td>-0.74026</td>\n      <td>51.42414</td>\n      <td>31f3071a-3138-4059-b9cd-279441b78d10</td>\n      <td>POLYGON ((-0.72071 51.41979, -0.72078 51.41927...</td>\n      <td>...</td>\n      <td>117.612</td>\n      <td>2124</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Better</td>\n      <td>Better</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3500</th>\n      <td>3266.0</td>\n      <td>E02003355</td>\n      <td>Bracknell Forest 004</td>\n      <td>Bracknell Forest 004</td>\n      <td>486030.0</td>\n      <td>169758.0</td>\n      <td>-0.76414</td>\n      <td>51.42031</td>\n      <td>74e3802a-22fa-476d-9574-9987b0adabb0</td>\n      <td>POLYGON ((-0.75417 51.41869, -0.76013 51.41353...</td>\n      <td>...</td>\n      <td>234.014</td>\n      <td>1515</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Similar</td>\n      <td>Worse</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n    <tr>\n      <th>3501</th>\n      <td>3267.0</td>\n      <td>E02003356</td>\n      <td>Bracknell Forest 005</td>\n      <td>Bracknell Forest 005</td>\n      <td>490476.0</td>\n      <td>167562.0</td>\n      <td>-0.70078</td>\n      <td>51.39988</td>\n      <td>3905ed89-433e-4322-8e30-e7c16404ebe1</td>\n      <td>POLYGON ((-0.68535 51.40142, -0.66763 51.38457...</td>\n      <td>...</td>\n      <td>46.210</td>\n      <td>1470</td>\n      <td>NaN</td>\n      <td>Cannot be calculated</td>\n      <td>Better</td>\n      <td>Better</td>\n      <td>20190000</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>1y</td>\n    </tr>\n  </tbody>\n</table>\n<p>5 rows × 37 columns</p>\n</div>\n```\n:::\n:::\n\n\nFinally, we can plot the data onto OpenStreetMap using the `contextily` package.\n\n`matplotlib.pyplot` plots the boundary shapes coloured by percentage using the polygon geometry data from the geopandas dataframe.\n\n::: {#cell-plot-map .cell execution_count=16}\n``` {.python .cell-code}\nax = boundary_df.plot(column= 'Value', legend=True, alpha = 0.6)\n\nax.axis('off')\nax.set_title('Percentage of Children Affected by Poverty in Bracknell Forest')\n\ncx.add_basemap(\n    ax,\n    crs=boundary_df.crs.to_string()\n)\n```\n\n::: {.cell-output .cell-output-display}\n![](fingertips_py_files/figure-html/plot-map-output-1.png){#plot-map}\n:::\n:::\n\n\n",
    "supporting": [
      "fingertips_py_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}
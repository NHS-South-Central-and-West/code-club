{
  "hash": "f6f947c61d7a56667fd672908bdc4d9d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: \"Beyond Linearity\"\nsubtitle: \"Adapting the Linear Model Framework for Non-Linear Patterns\"\nfooter: '**SAT //** Beyond Linearity **//** November, 2025'\nformat: revealjs\nexecute: \n    echo: false\n---\n\n\n# When Linear Regression Works {data-background-color=\"#425563\"}\n\nThe Linearity Assumption\n\n## Linear Models for Linear Effects {.center}\n\n- Linear regression fits a straight line through data\n- Assumes constant effect: each unit increase in $X$ changes $Y$ by the same amount\n- Works when the relationship is linear\n\n$$\nY = \\beta_0 + \\beta_1X + \\epsilon\n$$\n\n## Linear Relationships in the Real World {.center}\n\n::: {#cell-linear-example .cell execution_count=2}\n\n::: {.cell-output .cell-output-display}\n![](slides_files/figure-revealjs/linear-example-output-1.png){#linear-example}\n:::\n:::\n\n\n## But Real Data Isn't Always Linear {.center}\n\n- Growth curves (exponential, logistic)\n- Binary outcomes (survived/died, yes/no)\n- Count data (number of events)\n- Bounded outcomes (proportions, rates)\n- Curved relationships (U-shaped, S-shaped)\n\n# The Problem with Forcing Linearity {data-background-color=\"#425563\"}\n\nWhen Straight Lines Don't Fit\n\n## Probability of Disease by Age {.center}\n\n::: {#cell-nonlinear-problem .cell execution_count=3}\n\n::: {.cell-output .cell-output-display}\n![](slides_files/figure-revealjs/nonlinear-problem-output-1.png){#nonlinear-problem}\n:::\n:::\n\n\n## Fitting a Straight Line Fails {.center}\n\n::: {#cell-linear-fail .cell execution_count=4}\n\n::: {.cell-output .cell-output-display}\n![](slides_files/figure-revealjs/linear-fail-output-1.png){#linear-fail}\n:::\n:::\n\n\n## The Problem is the Scale {.center}\n\n- Linear regression assumes outcomes can take any value\n- But many outcomes are constrained:\n    - Probabilities must be between 0 and 1\n    - Counts must be non-negative integers\n    - Proportions are bounded\n- Forcing a straight line violates these constraints\n\n# Transform the Scale {data-background-color=\"#425563\"}\n\nLink Functions Make Non-Linear Data Linear\n\n## The Core Insight {.center}\n\n- Don't force data onto a straight line\n- Transform the scale so linear regression works\n- Fit the line on the transformed scale\n- Transform back to get predictions\n- This is what link functions do.\n\n## How Link Functions Work {.center}\n\n- The link function connects the linear predictor to the outcome: \n\n    1. Take your outcome $Y$ (bounded, binary, count, etc.)\n    2. Apply a transformation that \"stretches\" or \"squashes\" the scale\n    3. Fit a linear model on the transformed scale\n    4. Transform predictions back to the original scale\n\n## The Logit Link for Binary Outcomes {.center}\n\n- For binary outcomes (0 or 1), we model the **log-odds**:\n\n$$\n\\log\\left(\\frac{p}{1-p}\\right) = \\beta_0 + \\beta_1X\n$$\n\n- Left side: log-odds (can be any value)\n- Right side: linear predictor (can be any value)\n- Transform back to get probability: $p = \\frac{1}{1 + e^{-(\\beta_0 + \\beta_1X)}}$\n\n- This is **logistic regression**.\n\n## Visualising the Transformation {.center}\n\n::: {#cell-logit-transform .cell execution_count=5}\n\n::: {.cell-output .cell-output-display}\n![](slides_files/figure-revealjs/logit-transform-output-1.png){#logit-transform}\n:::\n:::\n\n\n## Logistic Regression Fits an S-Curve {.center}\n\n::: {#cell-logistic-fit .cell execution_count=6}\n\n::: {.cell-output .cell-output-display}\n![](slides_files/figure-revealjs/logistic-fit-output-1.png){#logistic-fit}\n:::\n:::\n\n\n# Generalised Linear Models {data-background-color=\"#425563\"}\n\nThe Family of Link Functions\n\n## Different Outcomes Need Different Links {.center}\n\n- **Binary outcomes** → Logit link → **Logistic regression**\n- **Count data** → Log link → **Poisson regression**\n- **Continuous positive** → Log link → **Log-linear models**\n- **Proportions** → Logit link → **Beta regression**\n\n- All follow the same pattern: transform, fit linear model, transform back.\n\n## Poisson Regression Uses Log Link {.center}\n\n- Model the log of the expected count:\n\n$$\n\\log(\\text{E}[Y]) = \\beta_0 + \\beta_1X\n$$\n\n- Left side: log of expected count (can be any value)\n- Right side: linear predictor (can be any value)\n- Transform back: $\\text{E}[Y] = e^{\\beta_0 + \\beta_1X}$\n- Predictions are always positive, matching count data.\n\n# Wrapping Up {data-background-color=\"#425563\"}\n\nKey Takeaways\n\n## What We've Learned {.center}\n\n- Real data often doesn't fit straight lines.\n- Link functions transform non-linear problems into linear ones.\n- Logistic regression (logit link) handles binary outcomes.\n- Poisson regression (log link) handles count data.\n- Linear regression isn't limited to linear relationships.\n\n## The Power of This Approach {.center}\n\n- Simplicity - Same core idea (fit a line) works everywhere.\n- Flexibility - Adapts to different data types and structures.\n- Interpretability - Coefficients still represent effects.\n- Extensibility - Once you know linear regression, you can learn anything.\n\n## Further Learning {.center}\n\n- StatQuest (Josh Starmer) - [Logistic Regression](https://www.youtube.com/watch?v=yIYKR4sgzI8)\n- Andrew Gelman et al. - [Regression & Other Stories](https://users.aalto.fi/~ave/ROS.pdf)\n\n## Thank You! {.center}\n\nContact:\n\n{{< fa solid envelope >}} [scwcsu.analytics.specialist@nhs.net](mailto:scwcsu.analytics.specialist@nhs.net)\n\nCode & Slides:\n\n{{< fa brands github >}} [/NHS-South-Central-and-West/code-club](https://github.com/nhs-south-central-and-west/code-club)\n\n... And don't forget to give us your [feedback](https://forms.office.com/e/g9fnSVPRwE).\n\n",
    "supporting": [
      "slides_files\\figure-revealjs"
    ],
    "filters": [],
    "includes": {}
  }
}